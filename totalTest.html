<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>ğŸ¢ì¼ì • ëª©ë¡ ì¡°íšŒ</title>


        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            html {
                font-size: 16px;
            }
            main {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            section {
                width: 100%;
                max-width: 1280px;
                padding: 2rem;
            }

            hr {
                width: 100%;
                max-width: 120px;
                height: 8px;
                background-color: #F4F4F5;
                border-radius: 999em;
                border: none;
            }

            input[type="text"] {
                font-size: 1rem;
                padding: 0 1.5rem;
                height: 4rem;
                border-radius: 1rem;
                border: 1px solid #F4F4F5;
                min-width: 0;
            }
            input[type="text"]::placeholder {
                color: #A0A0A9;
            }
            button {
                font-size: 1rem;
                padding: 0 1.5rem;
                height: 4rem;
                border-radius: 1rem;
            }
            button[type="submit"] {
                border: 1px solid #1A9E6A;
                background-color: #22C784;
                color: white;
            }

            #addTodoForm {
                display: flex;
                gap: 1rem;
            }
            #addTodoForm input[type="text"] {
                flex-grow: 1;
            }

            .todo-list-section ul {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }

            .todo-list-section li {
                list-style: none;
            }
            .todo-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 1rem;
                border: 1px solid #F4F4F5;
                border-radius: 1rem;
            }
            /* ì™„ë£Œëœ í•­ëª© ìŠ¤íƒ€ì¼ */
            .todo-item.completed {
                background-color: #F7FAF9; /* ì—°í•œ ë°°ê²½ìƒ‰ */
                border-color: #1A9E6A;
                opacity: 0.7;
            }

            .checkbox-wrapper {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            input[type="checkbox"] {
                appearance: none;
                -webkit-appearance: none;
                -moz-appearance: none;
                
                display: inline-block;
                width: 1.25rem;
                height: 1.25rem;
                margin-right: 0.5rem;
                vertical-align: middle;
                cursor: pointer;
                
                border: 1px solid #F4F4F5;
                border-radius: 0.5rem;
            }
            input[type="checkbox"]:checked {
                border: 1px solid #1A9E6A;
                background-color: #22C784;
                background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.5 12.75l6 6 9-13.5' stroke='%23ffffff' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
                background-size: 50%;
                background-position: center;
                background-repeat: no-repeat;
            }

            .todo-item button {
                border: 1px solid #F87171;
                background-color: #F87171;
                color: white;
                cursor: pointer;
            }
        </style>
    </head>

    <body>
        <main>
            <section class="add-todo-section">
                <form aria-label="ìƒˆ ì¼ì • ì¶”ê°€ í¼" id="addTodoForm">
                    <input type="text" placeholder="ìƒˆë¡œìš´ ì¼ì •ì„ ì¶”ê°€í•˜ì„¸ìš”" id="todoInput"/>
                    <button type="submit">ì¶”ê°€</button>
                </form>
            </section>

            <hr>

            <section class="todo-list-section">
                <ul id="todoListUl">

                </ul>
            </section>
        </main>

        <script>
            renderTodoList(selectTodoList());
            bindSubmitEvent();
            bindDynamicEvents();

            function bindDynamicEvents() {
                bindDeleteEvent();
                bindToggleEvent();
            }

            function bindSubmitEvent() {
                let addTodoForm = document.getElementById("addTodoForm");
                addTodoForm.onsubmit = function(e) {
                    e.preventDefault();

                    // insertTodoItem í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì¼ì •ì„ ì¶”ê°€í•œë‹¤.
                    insertTodoItem();
                    
                    // ì¼ì • ëª©ë¡ì„ ë‹¤ì‹œ ì¡°íšŒí•˜ê³  í™”ë©´ì— ë Œë”ë§í•œë‹¤.
                    renderTodoList(selectTodoList());
                    
                    // ìƒˆë¡œ ë Œë”ë§ëœ ìš”ì†Œë“¤ì— ì´ë²¤íŠ¸ë¥¼ ë‹¤ì‹œ ë°”ì¸ë”©í•œë‹¤.
                    bindDynamicEvents();
                };
            }
            
            function bindDeleteEvent() {
                // í™”ë©´ì— ìˆëŠ” ëª¨ë“  ì‚­ì œ ë²„íŠ¼(.delete-btn) ìš”ì†Œë“¤ì„ ê°€ì ¸ì™€ì„œ (deleteButtons) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let deleteButtons = document.querySelectorAll(".delete-btn");
                // ì¼ì • ëª©ë¡ ì„¹ì…˜(#todoListUl) ë‚´ì˜ ëª¨ë“  ì¸í’‹í•„ë“œ(input) ìš”ì†Œë“¤ì„ ê°€ì ¸ì™€ì„œ (checkboxes) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let checkboxes = document.querySelectorAll("#todoListUl input");

                // (deleteButtons) ë°°ì—´ì„ ìˆœíšŒí•œë‹¤.
                for (let i = 0; i < deleteButtons.length; i++) {
                    // (deleteButtons) ë°°ì—´ì˜ ië²ˆì§¸ ìš”ì†Œì— onclick ì´ë²¤íŠ¸ë¥¼ ì„¸íŒ…í•œë‹¤.
                    deleteButtons[i].onclick = function() {
                        // (checkboxes) ë°°ì—´ì˜ ië²ˆì§¸ ìš”ì†Œì— ìˆëŠ” id ê°’ì„ ê°€ì ¸ì™€ì„œ (todoItemId) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                        let todoItemId = checkboxes[i].id;
                        
                        // deleteTodoItem í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ (todoItemId) ê°’ì„ ì•„ì´ë””ë¡œ ê°€ì§„ ì¼ì •ì„ ì‚­ì œí•œë‹¤.
                        deleteTodoItem(todoItemId);
                        
                        // ì¼ì • ëª©ë¡ì„ ë‹¤ì‹œ ì¡°íšŒí•˜ê³  í™”ë©´ì— ë Œë”ë§í•œë‹¤.
                        renderTodoList(selectTodoList());
                        
                        // ìƒˆë¡œ ë Œë”ë§ëœ ìš”ì†Œë“¤ì— ì´ë²¤íŠ¸ë¥¼ ë‹¤ì‹œ ë°”ì¸ë”©í•œë‹¤.
                        bindDynamicEvents();
                    };
                }
            }

            function bindToggleEvent() {
                // ì¼ì • ëª©ë¡ ì„¹ì…˜(#todoListUl) ë‚´ì˜ ëª¨ë“  ì¸í’‹í•„ë“œ(input) ìš”ì†Œë“¤ì„ ê°€ì ¸ì™€ì„œ (checkboxes) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let checkboxes = document.querySelectorAll("#todoListUl input");

                // (checkboxes) ë°°ì—´ì„ ìˆœíšŒí•œë‹¤.
                for (let i = 0; i < checkboxes.length; i++) {
                    // (checkboxes) ë°°ì—´ì˜ ië²ˆì§¸ ìš”ì†Œì— onchange ì´ë²¤íŠ¸ë¥¼ ì„¸íŒ…í•œë‹¤.
                    checkboxes[i].onchange = function() {
                        // (checkboxes) ë°°ì—´ì˜ ië²ˆì§¸ ìš”ì†Œì— ìˆëŠ” id ê°’ì„ ê°€ì ¸ì™€ì„œ (todoItemId) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                        let todoItemId = checkboxes[i].id;
                        
                        // toggleTodoComplete í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ (todoItemId) ê°’ì„ ì•„ì´ë””ë¡œ ê°€ì§„ ì¼ì •ì˜ ì™„ë£Œì—¬ë¶€ë¥¼ ë³€ê²½í•œë‹¤.
                        toggleTodoComplete(todoItemId);
                        
                        // ì¼ì • ëª©ë¡ì„ ë‹¤ì‹œ ì¡°íšŒí•˜ê³  í™”ë©´ì— ë Œë”ë§í•œë‹¤.
                        renderTodoList(selectTodoList());
                        
                        // ìƒˆë¡œ ë Œë”ë§ëœ ìš”ì†Œë“¤ì— ì´ë²¤íŠ¸ë¥¼ ë‹¤ì‹œ ë°”ì¸ë”©í•œë‹¤.
                        bindDynamicEvents();
                    };
                }
            }

            // targetIdì— í•´ë‹¹í•˜ëŠ” ì¼ì •ì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ í† ê¸€í•˜ëŠ” í•¨ìˆ˜
            function deleteTodoItem(targetId) {
                // ë°°ì—´ ë³€ìˆ˜(todoList)ë¥¼ ìƒì„±í•˜ê³ , selectTodoList í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ (todoList)ì— í˜„ì¬ ì €ì¥ë˜ì–´ ìˆëŠ” ì¼ì • ëª©ë¡ì„ ë‹´ëŠ”ë‹¤.
                let todoList = selectTodoList();

                // (todoList) ë°°ì—´ì„ ìˆœíšŒí•˜ë©´ì„œ, id ê°’ì´ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ (targetId)ì™€ ë™ì¼í•˜ì§€ ì•Šì€ ë°ì´í„°ë“¤ë§Œ ì¶”ì¶œí•˜ì—¬ (updatedTodoList) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤. (í•„í„°ë§ì„ í†µí•œ ì‚­ì œ íš¨ê³¼)
                let updatedTodoList = todoList.filter(function(todoItem) {
                    return todoItem.id != targetId;
                });

                // (updatedTodoList) ë°°ì—´ì„ JSON ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•œ ë’¤ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤.(ì´ë•Œ, ë¡œì»¬ìŠ¤í† ë¦¬ì§€ í‚¤ ê°’ì€ "TODO_LIST_JSON"ë¡œ ì‚¬ìš©í•œë‹¤)
                updatedTodoList = JSON.stringify(updatedTodoList);
                localStorage.setItem("TODO_LIST_JSON", updatedTodoList);
            }

            function selectTodoList() {
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ì–´ ìˆëŠ” ì¼ì • ëª©ë¡ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ (todoListJson) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.( ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í‚¤ : "TODO_LIST_JSON")
                let todoListJson = localStorage.getItem("TODO_LIST_JSON");
                
                // (todoListJson) ë³€ìˆ˜ ê°’ì´ nullì´ê±°ë‚˜ undefinedê±°ë‚˜ ë¹ˆ ê°’ì´ë¼ë©´ (todoListJson) ë³€ìˆ˜ì— ë¹ˆ ë°°ì—´ ë¬¸ìì—´("[]")ì„ ë‹´ëŠ”ë‹¤.
                if (todoListJson == null || todoListJson == undefined || todoListJson == "") {
                    todoListJson = "[]";
                }

                // (todoListJson) ë³€ìˆ˜ ê°’ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„°ë¡œ ë³€í™˜í•˜ì—¬ (todoList) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let todoList = JSON.parse(todoListJson);

                // (todoList) ê°’ì„ ë°˜í™˜í•œë‹¤.
                return todoList;
            }

            // íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ ì¼ì • ëª©ë¡ì„ í™”ë©´ì— UIë¡œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
            function renderTodoList(todoList) {
                // ì¼ì • ëª©ë¡ì„ í‘œì‹œí•  ìš”ì†Œ(#todoListUl)ë¥¼ ê°€ì ¸ì™€ì„œ (todoListUl) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let todoListUl = document.getElementById("todoListUl");

                // (todoListUl) ìš”ì†Œì˜ ìì‹ ìš”ì†Œë“¤ì„ ëª¨ë‘ ì‚­ì œí•œë‹¤.
                todoListUl.innerHTML = "";

                // íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ (todoList) ë°ì´í„°ë¥¼ ìˆœíšŒí•œë‹¤. ì´ë•Œ, ì¸ë±ìŠ¤ ë³€ìˆ˜ (i)ë¥¼ ìƒì„±í•˜ì—¬ ìˆœíšŒí•œë‹¤.
                for (let i = 0;i < todoList.length; i++) {
                    // (todoList) ë°ì´í„° ì¤‘ (i)ë²ˆì§¸ ì¼ì • ë°ì´í„°ë¥¼ (todoItem) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                    let todoItem = todoList[i];

                    // (todoItem) ê°ì²´ì˜ id ê°’ì„ (todoItemId) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                    let todoItemId = todoItem.id;

                    // (todoItem) ê°ì²´ì˜ title ê°’ì„ (todoItemTitle) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                    let todoItemTitle = todoItem.title;

                    // (todoItem) ê°ì²´ì˜ isCompleted ê°’ì„ (isTodoItemCompleted) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                    let isTodoItemCompleted = todoItem.isCompleted;

                    // (todoItemTitle), (isTodoItemCompleted), (todoItemId) ë³€ìˆ˜ë“¤ì„ ì´ìš©í•˜ì—¬ (i)ë²ˆì§¸ ì¼ì • ë°ì´í„°ë¥¼ í™”ë©´ì— ê·¸ë¦°ë‹¤.
                    todoListUl.innerHTML += `
                        <li>
                            <article class="todo-item ${isTodoItemCompleted ? 'completed' : ''}">
                                <div class="checkbox-wrapper">
                                    <input type="checkbox" id="${todoItemId}" ${isTodoItemCompleted ? 'checked' : ''}/>
                                    <label for="${todoItemId}">${todoItemTitle}</label>
                                </div>
                                <button type="button" class="delete-btn">ì‚­ì œ</button>
                            </article>
                        </li>
                    `;
                }
            }

            function insertTodoItem() {
                // ë³€ìˆ˜(todoInputEl)ë¥¼ ìƒì„±í•˜ê³ , ì‚¬ìš©ìê°€ ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ëŠ” input ìš”ì†Œë¥¼ ê°€ì ¸ì™€ì„œ (todoInputEl) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let todoInputEl = document.getElementById("todoInput");

                // (todoInputEl) ìš”ì†Œì˜ ê°’ì„ ë‹´ì€ ë³€ìˆ˜(todoTitle)ë¥¼ ìƒì„±í•œë‹¤.
                let todoTitle = todoInputEl.value;

                // (todoTitle) ê°’ì´ ë¹ˆ ê°’ì¸ ê²½ìš° "ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”."ë¼ëŠ” ê²½ê³  ë©”ì„¸ì§€ë¥¼ í‘œì‹œí•˜ê³  í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•œë‹¤.
                if (todoTitle == "") {
                    alert("ì¼ì • ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.");
                    return;
                }

                // ê°ì²´ ë³€ìˆ˜(newTodoItem)ë¥¼ ìƒì„±í•˜ê³ , (newTodoItem) ê°ì²´ì— id ë©¤ë²„ë¥¼ í˜„ì¬ ì‹œê°„ ê°’ìœ¼ë¡œ ì„¸íŒ…í•œë‹¤.
                let newTodoItem = {};
                newTodoItem.id = new Date().getTime();

                // (newTodoItem) ê°ì²´ì˜ title ë©¤ë²„ ê°’ì„ (todoTitle) ê°’ìœ¼ë¡œ ì„¸íŒ…í•œë‹¤.
                newTodoItem.title = todoTitle;

                // (newTodoItem) ê°ì²´ì— isCompleted ë©¤ë²„ë¥¼ falseë¡œ ì„¸íŒ…í•œë‹¤.
                newTodoItem.isCompleted = false;

                // ë°°ì—´ ë³€ìˆ˜(todoList)ë¥¼ ìƒì„±í•˜ê³ , selectTodoList í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ (todoList)ì— í˜„ì¬ ì €ì¥ë˜ì–´ ìˆëŠ” ì¼ì • ëª©ë¡ì„ ë‹´ëŠ”ë‹¤.
                let todoList = selectTodoList();

                // (todoList) ë°°ì—´ì— (newTodoItem) ê°ì²´ë¥¼ ì¶”ê°€í•œë‹¤.
                todoList.push(newTodoItem);

                // (todoList) ë°°ì—´ì„ JSON ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•œ ë’¤ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤.(ì´ë•Œ, ë¡œì»¬ìŠ¤í† ë¦¬ì§€ í‚¤ ê°’ì€ "TODO_LIST_JSON"ë¡œ ì‚¬ìš©í•œë‹¤)
                todoList = JSON.stringify(todoList);
                localStorage.setItem("TODO_LIST_JSON", todoList);

                // (todoInputEl) ìš”ì†Œì˜ ê°’ì„ ë¹ˆ ë¬¸ìì—´ë¡œ ì´ˆê¸°í™”í•œë‹¤.
                todoInputEl.value = "";
            }

            // targetIdì— í•´ë‹¹í•˜ëŠ” ì¼ì •ì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ í† ê¸€í•˜ëŠ” í•¨ìˆ˜
            function toggleTodoComplete(targetId) {
                // ë°°ì—´ ë³€ìˆ˜(todoList)ë¥¼ ìƒì„±í•˜ê³ , selectTodoList í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ (todoList)ì— í˜„ì¬ ì €ì¥ë˜ì–´ ìˆëŠ” ì¼ì • ëª©ë¡ì„ ë‹´ëŠ”ë‹¤.
                let todoList = selectTodoList();

                // (todoList)ì˜ ì¼ì • ë°ì´í„° ì¤‘ì—ì„œ id ê°’ì´ í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ (targetId)ì™€ ë™ì¼í•œ ë°ì´í„°ë¥¼ í•„í„°ë§í•œ ê²°ê³¼ê°’ ì¤‘ ì²«ë²ˆì§¸ ê°’ì„ (targetTodoItem) ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
                let targetTodoItem = todoList.filter(function(todoItem) {
                    return todoItem.id == targetId;
                })[0];

                // (targetTodoItem)ì´ undefinedë¼ë©´ "í•´ë‹¹ ì¼ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." ë©”ì„¸ì§€ í‘œì‹œ í›„ í•¨ìˆ˜ ì¢…ë£Œ
                if (targetTodoItem == undefined) {
                    alert("í•´ë‹¹ ì¼ì •ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                    return;
                }

                // (targetTodoItem) ê°ì²´ì˜ isCompleted ê°’ì´ trueì˜€ë‹¤ë©´ falseë¡œ, falseì˜€ë‹¤ë©´ trueë¡œ ë³€ê²½í•œë‹¤.
                if (targetTodoItem.isCompleted) {
                    targetTodoItem.isCompleted = false;
                } else {
                    targetTodoItem.isCompleted = true;
                }

                // (todoList) ë°°ì—´ì„ JSON ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•œ ë’¤ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤.(ì´ë•Œ, ë¡œì»¬ìŠ¤í† ë¦¬ì§€ í‚¤ ê°’ì€ "TODO_LIST_JSON"ë¡œ ì‚¬ìš©í•œë‹¤)
                todoList = JSON.stringify(todoList);
                localStorage.setItem("TODO_LIST_JSON", todoList);
            }
        </script>
    </body>
</html>
